"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BuildingLamdaStacks = void 0;
const aws_cdk_lib_1 = require("aws-cdk-lib");
const appsync = require("aws-cdk-lib/aws-appsync");
const helpers_1 = require("./helpers");
const path_1 = require("path");
class BuildingLamdaStacks extends aws_cdk_lib_1.Stack {
    constructor(scope, id, props) {
        super(scope, id, props);
        const { acmsDatabase, acmsGraphqlApi } = props;
        const buildingFunction = new appsync.AppsyncFunction(this, "createBuilding", {
            name: "createBuilding",
            api: acmsGraphqlApi,
            dataSource: acmsGraphqlApi.addDynamoDbDataSource("acmsBuildingDataSource", acmsDatabase),
            code: (0, helpers_1.bundleAppSyncResolver)("src/resolvers/building/createBuilding.ts"),
            runtime: appsync.FunctionRuntime.JS_1_0_0,
        });
        new appsync.Resolver(this, "createBuildingResolver", {
            api: acmsGraphqlApi,
            typeName: "Mutation",
            fieldName: "createBuilding",
            code: appsync.Code.fromAsset((0, path_1.join)(__dirname, "./js_resolvers/_before_and_after_mapping_template.js")),
            runtime: appsync.FunctionRuntime.JS_1_0_0,
            pipelineConfig: [buildingFunction],
        });
    }
}
exports.BuildingLamdaStacks = BuildingLamdaStacks;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYnVpbGRpbmctbGFtYmRhLXN0YWNrLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiYnVpbGRpbmctbGFtYmRhLXN0YWNrLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLDZDQUFnRDtBQUdoRCxtREFBbUQ7QUFDbkQsdUNBQWtEO0FBQ2xELCtCQUE0QjtBQU81QixNQUFhLG1CQUFvQixTQUFRLG1CQUFLO0lBQzVDLFlBQVksS0FBZ0IsRUFBRSxFQUFVLEVBQUUsS0FBK0I7UUFDdkUsS0FBSyxDQUFDLEtBQUssRUFBRSxFQUFFLEVBQUUsS0FBSyxDQUFDLENBQUM7UUFFeEIsTUFBTSxFQUFFLFlBQVksRUFBRSxjQUFjLEVBQUUsR0FBRyxLQUFLLENBQUM7UUFFL0MsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLE9BQU8sQ0FBQyxlQUFlLENBQ2xELElBQUksRUFDSixnQkFBZ0IsRUFDaEI7WUFDRSxJQUFJLEVBQUUsZ0JBQWdCO1lBQ3RCLEdBQUcsRUFBRSxjQUFjO1lBQ25CLFVBQVUsRUFBRSxjQUFjLENBQUMscUJBQXFCLENBQzlDLHdCQUF3QixFQUN4QixZQUFZLENBQ2I7WUFDRCxJQUFJLEVBQUUsSUFBQSwrQkFBcUIsRUFBQywwQ0FBMEMsQ0FBQztZQUN2RSxPQUFPLEVBQUUsT0FBTyxDQUFDLGVBQWUsQ0FBQyxRQUFRO1NBQzFDLENBQ0YsQ0FBQztRQUVGLElBQUksT0FBTyxDQUFDLFFBQVEsQ0FBQyxJQUFJLEVBQUUsd0JBQXdCLEVBQUU7WUFDbkQsR0FBRyxFQUFFLGNBQWM7WUFDbkIsUUFBUSxFQUFFLFVBQVU7WUFDcEIsU0FBUyxFQUFFLGdCQUFnQjtZQUMzQixJQUFJLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQzFCLElBQUEsV0FBSSxFQUFDLFNBQVMsRUFBRSxzREFBc0QsQ0FBQyxDQUN4RTtZQUNELE9BQU8sRUFBRSxPQUFPLENBQUMsZUFBZSxDQUFDLFFBQVE7WUFDekMsY0FBYyxFQUFFLENBQUMsZ0JBQWdCLENBQUM7U0FDbkMsQ0FBQyxDQUFDO0lBRUwsQ0FBQztDQUNGO0FBakNELGtEQWlDQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN0YWNrLCBTdGFja1Byb3BzIH0gZnJvbSBcImF3cy1jZGstbGliXCI7XG5pbXBvcnQgeyBUYWJsZSB9IGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtZHluYW1vZGJcIjtcbmltcG9ydCB7IENvbnN0cnVjdCB9IGZyb20gXCJjb25zdHJ1Y3RzXCI7XG5pbXBvcnQgKiBhcyBhcHBzeW5jIGZyb20gXCJhd3MtY2RrLWxpYi9hd3MtYXBwc3luY1wiO1xuaW1wb3J0IHsgYnVuZGxlQXBwU3luY1Jlc29sdmVyIH0gZnJvbSBcIi4vaGVscGVyc1wiO1xuaW1wb3J0IHsgam9pbiB9IGZyb20gXCJwYXRoXCI7XG5cbmludGVyZmFjZSBCdWlsZGluZ0xhbWJkYVN0YWNrUHJvcHMgZXh0ZW5kcyBTdGFja1Byb3BzIHtcbiAgYWNtc0dyYXBocWxBcGk6IGFwcHN5bmMuR3JhcGhxbEFwaTtcbiAgYWNtc0RhdGFiYXNlOiBUYWJsZTtcbn1cblxuZXhwb3J0IGNsYXNzIEJ1aWxkaW5nTGFtZGFTdGFja3MgZXh0ZW5kcyBTdGFjayB7XG4gIGNvbnN0cnVjdG9yKHNjb3BlOiBDb25zdHJ1Y3QsIGlkOiBzdHJpbmcsIHByb3BzOiBCdWlsZGluZ0xhbWJkYVN0YWNrUHJvcHMpIHtcbiAgICBzdXBlcihzY29wZSwgaWQsIHByb3BzKTtcblxuICAgIGNvbnN0IHsgYWNtc0RhdGFiYXNlLCBhY21zR3JhcGhxbEFwaSB9ID0gcHJvcHM7XG5cbiAgICBjb25zdCBidWlsZGluZ0Z1bmN0aW9uID0gbmV3IGFwcHN5bmMuQXBwc3luY0Z1bmN0aW9uKFxuICAgICAgdGhpcyxcbiAgICAgIFwiY3JlYXRlQnVpbGRpbmdcIixcbiAgICAgIHtcbiAgICAgICAgbmFtZTogXCJjcmVhdGVCdWlsZGluZ1wiLFxuICAgICAgICBhcGk6IGFjbXNHcmFwaHFsQXBpLFxuICAgICAgICBkYXRhU291cmNlOiBhY21zR3JhcGhxbEFwaS5hZGREeW5hbW9EYkRhdGFTb3VyY2UoXG4gICAgICAgICAgXCJhY21zQnVpbGRpbmdEYXRhU291cmNlXCIsXG4gICAgICAgICAgYWNtc0RhdGFiYXNlXG4gICAgICAgICksXG4gICAgICAgIGNvZGU6IGJ1bmRsZUFwcFN5bmNSZXNvbHZlcihcInNyYy9yZXNvbHZlcnMvYnVpbGRpbmcvY3JlYXRlQnVpbGRpbmcudHNcIiksXG4gICAgICAgIHJ1bnRpbWU6IGFwcHN5bmMuRnVuY3Rpb25SdW50aW1lLkpTXzFfMF8wLFxuICAgICAgfVxuICAgICk7XG5cbiAgICBuZXcgYXBwc3luYy5SZXNvbHZlcih0aGlzLCBcImNyZWF0ZUJ1aWxkaW5nUmVzb2x2ZXJcIiwge1xuICAgICAgYXBpOiBhY21zR3JhcGhxbEFwaSxcbiAgICAgIHR5cGVOYW1lOiBcIk11dGF0aW9uXCIsXG4gICAgICBmaWVsZE5hbWU6IFwiY3JlYXRlQnVpbGRpbmdcIixcbiAgICAgIGNvZGU6IGFwcHN5bmMuQ29kZS5mcm9tQXNzZXQoXG4gICAgICAgIGpvaW4oX19kaXJuYW1lLCBcIi4vanNfcmVzb2x2ZXJzL19iZWZvcmVfYW5kX2FmdGVyX21hcHBpbmdfdGVtcGxhdGUuanNcIilcbiAgICAgICksXG4gICAgICBydW50aW1lOiBhcHBzeW5jLkZ1bmN0aW9uUnVudGltZS5KU18xXzBfMCxcbiAgICAgIHBpcGVsaW5lQ29uZmlnOiBbYnVpbGRpbmdGdW5jdGlvbl0sXG4gICAgfSk7XG5cbiAgfVxufVxuIl19